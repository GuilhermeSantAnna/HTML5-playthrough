<html>
<head>
	<script language="javascript">
	var context;

	var rua = {
	    imagem: new Image(),
	    pos_x:0,
	    pos_y:0,
	    draw: function(context){
	        context.drawImage(this.imagem, this.pos_x, this.pos_y);
	        context.drawImage(this.imagem, this.pos_x, this.pos_y - this.imagem.height);
	    },
	    atualiza_posicao: function(){
	        (this.pos_y > this.imagem.height  ) ? this.pos_y = 0 : this.pos_y += 5;
	    }
	}

	var carro = {
	    imagem: new Image(),
	    pos_x:250,
	    pos_y:450,
	    draw: function(context){
    		context.drawImage(this.imagem, this.pos_x, this.pos_y, this.imagem.width/3,this.imagem.height/3);
	    },
	    movimentar: function(e){
	        console.log("asdf"  )
		    if (e.keyCode == 39) this.pos_x ++; // Direita
		    if (e.keyCode == 37) this.pos_x --; // Esquerda
	    }
	}

	function Initialize()
	{
		var canvas = document.getElementById("tela");

		if(canvas.getContext)
		{
			context = canvas.getContext("2d");
			rua.imagem.src = "../media/road.jpg";
			carro.imagem.src = "../media/gray-car-top-view-md.png" // TODO arranjar uma imagem melhor pro carros

            window.onkeydown = carro.movimentar;

			setInterval(Run, 16.6);
		}
	}

	function Run()
	{
		Update();
		Draw();
	}

	function Update()
	{
	    rua.atualiza_posicao();
	    window.onkeydown = carro.movimentar();
	}

	function Draw()
	{
		context.clearRect(0,0,800,600);
        context.save();
            rua.draw(context);
            carro.draw(context);
        context.restore();
	}
	</script>
</head>
<body onload="Initialize()">
	<canvas id="tela" width="500" height="500" style="background-color:#ffff00;">
		Canvas do HTML5 não suportado pelo Browser.
	</canvas>
</body>
</html>

